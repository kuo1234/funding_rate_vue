{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { ref, computed, onMounted, onUnmounted } from 'vue';\nimport { io } from 'socket.io-client';\nexport default {\n  __name: 'App',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const fundingRates = ref([]);\n    const sortKey = ref('symbol');\n    const sortDesc = ref(false);\n    let socket = null;\n    function rateClass(rate) {\n      if (rate === null || rate === undefined) return '';\n      return Math.abs(rate) > 0.5 ? 'high' : Math.abs(rate) > 0.2 ? 'mid' : '';\n    }\n    function formatRate(rate) {\n      return rate !== null && rate !== undefined ? rate.toFixed(4) + '%' : '';\n    }\n    function formatSymbol(symbol) {\n      if (!symbol) return '';\n      // 移除 USDT 後綴用於顯示\n      return symbol.replace(/USDT$/i, '').toUpperCase();\n    }\n    function setSort(key) {\n      if (sortKey.value === key) {\n        sortDesc.value = !sortDesc.value;\n      } else {\n        sortKey.value = key;\n        sortDesc.value = false;\n      }\n    }\n    const sortedRates = computed(() => {\n      const arr = [...fundingRates.value];\n      arr.sort((a, b) => {\n        let v1 = a[sortKey.value];\n        let v2 = b[sortKey.value];\n        if (sortKey.value === 'symbol') {\n          v1 = v1?.toUpperCase() || '';\n          v2 = v2?.toUpperCase() || '';\n          return sortDesc.value ? v2.localeCompare(v1) : v1.localeCompare(v2);\n        } else {\n          v1 = v1 ?? -Infinity;\n          v2 = v2 ?? -Infinity;\n          return sortDesc.value ? v2 - v1 : v1 - v2;\n        }\n      });\n      return arr;\n    });\n    async function fetchInitialData() {\n      const res = await fetch('http://localhost:5000/api/funding_rates');\n      const data = await res.json();\n      fundingRates.value = data;\n    }\n    onMounted(() => {\n      fetchInitialData();\n      socket = io('http://localhost:5000');\n      socket.on('funding_rate_update', update => {\n        const idx = fundingRates.value.findIndex(i => i.symbol === update.symbol);\n        if (idx >= 0) {\n          fundingRates.value[idx][update.exchange.toLowerCase()] = update.rate;\n        } else {\n          fundingRates.value.push({\n            symbol: update.symbol,\n            btcc: null,\n            mexc: update.exchange === 'MEXC' ? update.rate : null,\n            bingx: null\n          });\n        }\n      });\n    });\n    onUnmounted(() => {\n      if (socket) socket.disconnect();\n    });\n    const __returned__ = {\n      fundingRates,\n      sortKey,\n      sortDesc,\n      get socket() {\n        return socket;\n      },\n      set socket(v) {\n        socket = v;\n      },\n      rateClass,\n      formatRate,\n      formatSymbol,\n      setSort,\n      sortedRates,\n      fetchInitialData,\n      ref,\n      computed,\n      onMounted,\n      onUnmounted,\n      get io() {\n        return io;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","computed","onMounted","onUnmounted","io","fundingRates","sortKey","sortDesc","socket","rateClass","rate","undefined","Math","abs","formatRate","toFixed","formatSymbol","symbol","replace","toUpperCase","setSort","key","value","sortedRates","arr","sort","a","b","v1","v2","localeCompare","Infinity","fetchInitialData","res","fetch","data","json","on","update","idx","findIndex","i","exchange","toLowerCase","push","btcc","mexc","bingx","disconnect"],"sources":["C:/Users/kuo/Desktop/btcc/funding_rate_vue/src/App.vue"],"sourcesContent":["<template>\r\n  <div class=\"container\">\r\n    <h2>Funding Rate Board</h2>\r\n    <table>\r\n      <thead>\r\n        <tr>\r\n          <th @click=\"setSort('symbol')\" style=\"cursor:pointer\">\r\n            Symbol <span v-if=\"sortKey==='symbol'\">{{ sortDesc ? '↓' : '↑' }}</span>\r\n          </th>\r\n          <th @click=\"setSort('btcc')\" style=\"cursor:pointer\">\r\n            BTCC <span v-if=\"sortKey==='btcc'\">{{ sortDesc ? '↓' : '↑' }}</span>\r\n          </th>\r\n          <th @click=\"setSort('mexc')\" style=\"cursor:pointer\">\r\n            MEXC <span v-if=\"sortKey==='mexc'\">{{ sortDesc ? '↓' : '↑' }}</span>\r\n          </th>\r\n          <th @click=\"setSort('bingx')\" style=\"cursor:pointer\">\r\n            BINGX <span v-if=\"sortKey==='bingx'\">{{ sortDesc ? '↓' : '↑' }}</span>\r\n          </th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr v-for=\"item in sortedRates\" :key=\"item.symbol\">\r\n          <td>{{ formatSymbol(item.symbol) }}</td>\r\n          <td :class=\"rateClass(item.btcc)\">{{ formatRate(item.btcc) }}</td>\r\n          <td :class=\"rateClass(item.mexc)\">{{ formatRate(item.mexc) }}</td>\r\n          <td :class=\"rateClass(item.bingx)\">{{ formatRate(item.bingx) }}</td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed, onMounted, onUnmounted } from 'vue'\r\nimport { io } from 'socket.io-client'\r\n\r\nconst fundingRates = ref([])\r\nconst sortKey = ref('symbol')\r\nconst sortDesc = ref(false)\r\nlet socket = null\r\n\r\nfunction rateClass(rate) {\r\n  if (rate === null || rate === undefined) return ''\r\n  return Math.abs(rate) > 0.5 ? 'high' : Math.abs(rate) > 0.2 ? 'mid' : ''\r\n}\r\n\r\nfunction formatRate(rate) {\r\n  return rate !== null && rate !== undefined ? rate.toFixed(4) + '%' : ''\r\n}\r\n\r\nfunction formatSymbol(symbol) {\r\n  if (!symbol) return ''\r\n  // 移除 USDT 後綴用於顯示\r\n  return symbol.replace(/USDT$/i, '').toUpperCase()\r\n}\r\n\r\nfunction setSort(key) {\r\n  if (sortKey.value === key) {\r\n    sortDesc.value = !sortDesc.value\r\n  } else {\r\n    sortKey.value = key\r\n    sortDesc.value = false\r\n  }\r\n}\r\n\r\nconst sortedRates = computed(() => {\r\n  const arr = [...fundingRates.value]\r\n  arr.sort((a, b) => {\r\n    let v1 = a[sortKey.value]\r\n    let v2 = b[sortKey.value]\r\n    if (sortKey.value === 'symbol') {\r\n      v1 = v1?.toUpperCase() || ''\r\n      v2 = v2?.toUpperCase() || ''\r\n      return sortDesc.value ? v2.localeCompare(v1) : v1.localeCompare(v2)\r\n    } else {\r\n      v1 = v1 ?? -Infinity\r\n      v2 = v2 ?? -Infinity\r\n      return sortDesc.value ? v2 - v1 : v1 - v2\r\n    }\r\n  })\r\n  return arr\r\n})\r\n\r\nasync function fetchInitialData() {\r\n  const res = await fetch('http://localhost:5000/api/funding_rates')\r\n  const data = await res.json()\r\n  fundingRates.value = data\r\n}\r\n\r\nonMounted(() => {\r\n  fetchInitialData()\r\n  socket = io('http://localhost:5000')\r\n  socket.on('funding_rate_update', (update) => {\r\n    const idx = fundingRates.value.findIndex(i => i.symbol === update.symbol)\r\n    if (idx >= 0) {\r\n      fundingRates.value[idx][update.exchange.toLowerCase()] = update.rate\r\n    } else {\r\n      fundingRates.value.push({\r\n        symbol: update.symbol,\r\n        btcc: null,\r\n        mexc: update.exchange === 'MEXC' ? update.rate : null,\r\n        bingx: null\r\n      })\r\n    }\r\n  })\r\n})\r\n\r\nonUnmounted(() => {\r\n  if (socket) socket.disconnect()\r\n})\r\n</script>\r\n\r\n<style>\r\nbody { background: #181818; color: #eee; font-family: 'Segoe UI', Arial, sans-serif; }\r\n.container { max-width: 900px; margin: 40px auto; background: #222; padding: 24px; border-radius: 12px; box-shadow: 0 2px 16px #0008; }\r\nh2 { text-align: center; margin-bottom: 24px; color: #00bfff; }\r\ntable { border-collapse: collapse; width: 100%; background: #222; }\r\nth, td { border: 1px solid #333; padding: 12px 8px; text-align: center; }\r\nth { background: #333; color: #fff; font-size: 1.1em; }\r\ntr:nth-child(even) { background: #282828; }\r\n.high { color: #e74c3c; font-weight: bold; background: #2c0a0a; }\r\n.mid { color: #f39c12; font-weight: bold; background: #2c1a0a; }\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}