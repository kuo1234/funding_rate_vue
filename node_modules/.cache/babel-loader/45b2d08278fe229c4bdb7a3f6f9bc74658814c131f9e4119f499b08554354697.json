{"ast":null,"code":"import { ref, computed, onMounted, onUnmounted } from 'vue';\nexport default {\n  __name: 'App',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const fundingRates = ref([]);\n    let fetchTimer = null;\n    const sortKey = ref('symbol');\n    const sortDesc = ref(false);\n\n    // --- localStorage cache ---\n    function saveCache(data) {\n      localStorage.setItem('fundingRatesCache', JSON.stringify({\n        data,\n        ts: Date.now()\n      }));\n    }\n    function loadCache() {\n      const cache = localStorage.getItem('fundingRatesCache');\n      if (!cache) return null;\n      try {\n        const obj = JSON.parse(cache);\n        // �u��10���������֨�\n        if (Date.now() - obj.ts < 10 * 60 * 1000) {\n          return obj.data;\n        }\n      } catch {\n        // ignore cache parse error\n      }\n      return null;\n    }\n    function rateClass(rate) {\n      if (rate === null || rate === undefined) return '';\n      return Math.abs(rate) > 0.5 ? 'high' : Math.abs(rate) > 0.2 ? 'mid' : '';\n    }\n    function formatRate(rate) {\n      return rate !== null && rate !== undefined ? rate.toFixed(4) + '%' : '';\n    }\n    function setSort(key) {\n      if (sortKey.value === key) {\n        sortDesc.value = !sortDesc.value;\n      } else {\n        sortKey.value = key;\n        sortDesc.value = false;\n      }\n    }\n    const sortedRates = computed(() => {\n      const arr = [...fundingRates.value];\n      arr.sort((a, b) => {\n        let v1 = a[sortKey.value];\n        let v2 = b[sortKey.value];\n        if (sortKey.value === 'symbol') {\n          v1 = v1?.toUpperCase() || '';\n          v2 = v2?.toUpperCase() || '';\n          return sortDesc.value ? v2.localeCompare(v1) : v1.localeCompare(v2);\n        } else {\n          v1 = v1 ?? -Infinity;\n          v2 = v2 ?? -Infinity;\n          return sortDesc.value ? v2 - v1 : v1 - v2;\n        }\n      });\n      return arr;\n    });\n    async function fetchData() {\n      try {\n        const res = await fetch('http://localhost:5000/api/funding_rates');\n        const data = await res.json();\n        fundingRates.value = data;\n        saveCache(data);\n      } catch {\n        // �p�G���ѡA�ϥΧ֨�\n        const cache = loadCache();\n        if (cache) fundingRates.value = cache;\n      }\n    }\n    onMounted(() => {\n      // �������J���Χ֨�\n      const cache = loadCache();\n      if (cache) fundingRates.value = cache;\n      fetchData();\n      fetchTimer = setInterval(fetchData, 30000);\n    });\n    onUnmounted(() => {\n      if (fetchTimer) clearInterval(fetchTimer);\n    });\n    const __returned__ = {\n      fundingRates,\n      get fetchTimer() {\n        return fetchTimer;\n      },\n      set fetchTimer(v) {\n        fetchTimer = v;\n      },\n      sortKey,\n      sortDesc,\n      saveCache,\n      loadCache,\n      rateClass,\n      formatRate,\n      setSort,\n      sortedRates,\n      fetchData,\n      ref,\n      computed,\n      onMounted,\n      onUnmounted\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","computed","onMounted","onUnmounted","fundingRates","fetchTimer","sortKey","sortDesc","saveCache","data","localStorage","setItem","JSON","stringify","ts","Date","now","loadCache","cache","getItem","obj","parse","rateClass","rate","undefined","Math","abs","formatRate","toFixed","setSort","key","value","sortedRates","arr","sort","a","b","v1","v2","toUpperCase","localeCompare","Infinity","fetchData","res","fetch","json","setInterval","clearInterval"],"sources":["C:/Users/kuo/Desktop/btcc/funding_rate_vue/src/App.vue"],"sourcesContent":["<template>\r\n  <div class=\"container\">\r\n    <h2>Funding Rate Board</h2>\r\n    <button class=\"refresh-btn\" @click=\"fetchData\">Refresh</button>\r\n    <table>\r\n      <thead>\r\n        <tr>\r\n          <th @click=\"setSort('symbol')\" style=\"cursor:pointer\">\r\n            Symbol <span v-if=\"sortKey==='symbol'\">{{ sortDesc ? '��' : '��' }}</span>\r\n          </th>\r\n          <th @click=\"setSort('btcc')\" style=\"cursor:pointer\">\r\n            BTCC <span v-if=\"sortKey==='btcc'\">{{ sortDesc ? '��' : '��' }}</span>\r\n          </th>\r\n          <th @click=\"setSort('mexc')\" style=\"cursor:pointer\">\r\n            MEXC <span v-if=\"sortKey==='mexc'\">{{ sortDesc ? '��' : '��' }}</span>\r\n          </th>\r\n          <th @click=\"setSort('bingx')\" style=\"cursor:pointer\">\r\n            BINGX <span v-if=\"sortKey==='bingx'\">{{ sortDesc ? '��' : '��' }}</span>\r\n          </th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr v-for=\"item in sortedRates\" :key=\"item.symbol\">\r\n          <td>{{ item.symbol.toUpperCase() }}</td>\r\n          <td :class=\"rateClass(item.btcc)\">{{ formatRate(item.btcc) }}</td>\r\n          <td :class=\"rateClass(item.mexc)\">{{ formatRate(item.mexc) }}</td>\r\n          <td :class=\"rateClass(item.bingx)\">{{ formatRate(item.bingx) }}</td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed, onMounted, onUnmounted } from 'vue'\r\n\r\nconst fundingRates = ref([])\r\nlet fetchTimer = null\r\n\r\nconst sortKey = ref('symbol')\r\nconst sortDesc = ref(false)\r\n\r\n// --- localStorage cache ---\r\nfunction saveCache(data) {\r\n  localStorage.setItem('fundingRatesCache', JSON.stringify({\r\n    data,\r\n    ts: Date.now()\r\n  }))\r\n}\r\n\r\nfunction loadCache() {\r\n  const cache = localStorage.getItem('fundingRatesCache')\r\n  if (!cache) return null\r\n  try {\r\n    const obj = JSON.parse(cache)\r\n    // �u��10���������֨�\r\n    if (Date.now() - obj.ts < 10 * 60 * 1000) {\r\n      return obj.data\r\n    }\r\n  } catch {\r\n    // ignore cache parse error\r\n  }\r\n  return null\r\n}\r\n\r\nfunction rateClass(rate) {\r\n  if (rate === null || rate === undefined) return ''\r\n  return Math.abs(rate) > 0.5 ? 'high' : Math.abs(rate) > 0.2 ? 'mid' : ''\r\n}\r\n\r\nfunction formatRate(rate) {\r\n  return rate !== null && rate !== undefined ? rate.toFixed(4) + '%' : ''\r\n}\r\n\r\nfunction setSort(key) {\r\n  if (sortKey.value === key) {\r\n    sortDesc.value = !sortDesc.value\r\n  } else {\r\n    sortKey.value = key\r\n    sortDesc.value = false\r\n  }\r\n}\r\n\r\nconst sortedRates = computed(() => {\r\n  const arr = [...fundingRates.value]\r\n  arr.sort((a, b) => {\r\n    let v1 = a[sortKey.value]\r\n    let v2 = b[sortKey.value]\r\n    if (sortKey.value === 'symbol') {\r\n      v1 = v1?.toUpperCase() || ''\r\n      v2 = v2?.toUpperCase() || ''\r\n      return sortDesc.value ? v2.localeCompare(v1) : v1.localeCompare(v2)\r\n    } else {\r\n      v1 = v1 ?? -Infinity\r\n      v2 = v2 ?? -Infinity\r\n      return sortDesc.value ? v2 - v1 : v1 - v2\r\n    }\r\n  })\r\n  return arr\r\n})\r\n\r\nasync function fetchData() {\r\n  try {\r\n    const res = await fetch('http://localhost:5000/api/funding_rates')\r\n    const data = await res.json()\r\n    fundingRates.value = data\r\n    saveCache(data)\r\n  } catch {\r\n    // �p�G���ѡA�ϥΧ֨�\r\n    const cache = loadCache()\r\n    if (cache) fundingRates.value = cache\r\n  }\r\n}\r\n\r\nonMounted(() => {\r\n  // �������J���Χ֨�\r\n  const cache = loadCache()\r\n  if (cache) fundingRates.value = cache\r\n  fetchData()\r\n  fetchTimer = setInterval(fetchData, 30000)\r\n})\r\nonUnmounted(() => {\r\n  if (fetchTimer) clearInterval(fetchTimer)\r\n})\r\n</script>\r\n\r\n<style>\r\nbody { background: #181818; color: #eee; font-family: 'Segoe UI', Arial, sans-serif; }\r\n.container { max-width: 900px; margin: 40px auto; background: #222; padding: 24px; border-radius: 12px; box-shadow: 0 2px 16px #0008; }\r\nh2 { text-align: center; margin-bottom: 24px; color: #00bfff; }\r\n.refresh-btn {\r\n  display: block;\r\n  margin: 0 auto 16px auto;\r\n  padding: 8px 24px;\r\n  background: #00bfff;\r\n  color: #fff;\r\n  border: none;\r\n  border-radius: 6px;\r\n  font-size: 1em;\r\n  cursor: pointer;\r\n  transition: background 0.2s;\r\n}\r\n.refresh-btn:hover {\r\n  background: #0099cc;\r\n}\r\ntable { border-collapse: collapse; width: 100%; background: #222; }\r\nth, td { border: 1px solid #333; padding: 12px 8px; text-align: center; }\r\nth { background: #333; color: #fff; font-size: 1.1em; }\r\ntr:nth-child(even) { background: #282828; }\r\n.high { color: #e74c3c; font-weight: bold; background: #2c0a0a; }\r\n.mid { color: #f39c12; font-weight: bold; background: #2c1a0a; }\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}