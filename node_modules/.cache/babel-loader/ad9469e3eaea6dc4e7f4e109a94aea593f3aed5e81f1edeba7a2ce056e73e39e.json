{"ast":null,"code":"import { ref, computed, onMounted, onUnmounted } from 'vue';\nexport default {\n  __name: 'App',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const fundingRates = ref([]);\n    let fetchTimer = null;\n    const sortKey = ref('symbol');\n    const sortDesc = ref(false);\n\n    // --- localStorage cache ---\n    function saveCache(data) {\n      localStorage.setItem('fundingRatesCache', JSON.stringify({\n        data,\n        ts: Date.now()\n      }));\n    }\n    function loadCache() {\n      const cache = localStorage.getItem('fundingRatesCache');\n      if (!cache) return null;\n      try {\n        const obj = JSON.parse(cache);\n        // �u��10���������֨�\n        if (Date.now() - obj.ts < 10 * 60 * 1000) {\n          return obj.data;\n        }\n      } catch {\n        // ignore cache parse error\n      }\n      return null;\n    }\n    function rateClass(rate) {\n      if (rate === null || rate === undefined) return '';\n      return Math.abs(rate) > 0.5 ? 'high' : Math.abs(rate) > 0.2 ? 'mid' : '';\n    }\n    function formatRate(rate) {\n      return rate !== null && rate !== undefined ? rate.toFixed(4) + '%' : '';\n    }\n    function setSort(key) {\n      if (sortKey.value === key) {\n        sortDesc.value = !sortDesc.value;\n      } else {\n        sortKey.value = key;\n        sortDesc.value = false;\n      }\n    }\n    const sortedRates = computed(() => {\n      const arr = [...fundingRates.value];\n      arr.sort((a, b) => {\n        let v1 = a[sortKey.value];\n        let v2 = b[sortKey.value];\n        if (sortKey.value === 'symbol') {\n          v1 = v1?.toUpperCase() || '';\n          v2 = v2?.toUpperCase() || '';\n          return sortDesc.value ? v2.localeCompare(v1) : v1.localeCompare(v2);\n        } else {\n          v1 = v1 ?? -Infinity;\n          v2 = v2 ?? -Infinity;\n          return sortDesc.value ? v2 - v1 : v1 - v2;\n        }\n      });\n      return arr;\n    });\n    async function fetchData() {\n      try {\n        const res = await fetch('http://localhost:5000/api/funding_rates');\n        const data = await res.json();\n        fundingRates.value = data;\n        saveCache(data);\n      } catch {\n        // �p�G���ѡA�ϥΧ֨�\n        const cache = loadCache();\n        if (cache) fundingRates.value = cache;\n      }\n    }\n    onMounted(() => {\n      // �������J���Χ֨�\n      const cache = loadCache();\n      if (cache) fundingRates.value = cache;\n      fetchData();\n      fetchTimer = setInterval(fetchData, 30000);\n    });\n    onUnmounted(() => {\n      if (fetchTimer) clearInterval(fetchTimer);\n    });\n    const __returned__ = {\n      fundingRates,\n      get fetchTimer() {\n        return fetchTimer;\n      },\n      set fetchTimer(v) {\n        fetchTimer = v;\n      },\n      sortKey,\n      sortDesc,\n      saveCache,\n      loadCache,\n      rateClass,\n      formatRate,\n      setSort,\n      sortedRates,\n      fetchData,\n      ref,\n      computed,\n      onMounted,\n      onUnmounted\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","computed","onMounted","onUnmounted","fundingRates","fetchTimer","sortKey","sortDesc","saveCache","data","localStorage","setItem","JSON","stringify","ts","Date","now","loadCache","cache","getItem","obj","parse","rateClass","rate","undefined","Math","abs","formatRate","toFixed","setSort","key","value","sortedRates","arr","sort","a","b","v1","v2","toUpperCase","localeCompare","Infinity","fetchData","res","fetch","json","setInterval","clearInterval"],"sources":["C:/Users/kuoth/Desktop/btcc/btcc-funding-board/src/App.vue"],"sourcesContent":["<template>\n  <div class=\"container\">\n    <h2>Funding Rate Board</h2>\n    <button class=\"refresh-btn\" @click=\"fetchData\">Refresh</button>\n    <table>\n      <thead>\n        <tr>\n          <th @click=\"setSort('symbol')\" style=\"cursor:pointer\">\n            Symbol <span v-if=\"sortKey==='symbol'\">{{ sortDesc ? '��' : '��' }}</span>\n          </th>\n          <th @click=\"setSort('btcc')\" style=\"cursor:pointer\">\n            BTCC <span v-if=\"sortKey==='btcc'\">{{ sortDesc ? '��' : '��' }}</span>\n          </th>\n          <th @click=\"setSort('mexc')\" style=\"cursor:pointer\">\n            MEXC <span v-if=\"sortKey==='mexc'\">{{ sortDesc ? '��' : '��' }}</span>\n          </th>\n          <th @click=\"setSort('bingx')\" style=\"cursor:pointer\">\n            BINGX <span v-if=\"sortKey==='bingx'\">{{ sortDesc ? '��' : '��' }}</span>\n          </th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr v-for=\"item in sortedRates\" :key=\"item.symbol\">\n          <td>{{ item.symbol.toUpperCase() }}</td>\n          <td :class=\"rateClass(item.btcc)\">{{ formatRate(item.btcc) }}</td>\n          <td :class=\"rateClass(item.mexc)\">{{ formatRate(item.mexc) }}</td>\n          <td :class=\"rateClass(item.bingx)\">{{ formatRate(item.bingx) }}</td>\n        </tr>\n      </tbody>\n    </table>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted, onUnmounted } from 'vue'\n\nconst fundingRates = ref([])\nlet fetchTimer = null\n\nconst sortKey = ref('symbol')\nconst sortDesc = ref(false)\n\n// --- localStorage cache ---\nfunction saveCache(data) {\n  localStorage.setItem('fundingRatesCache', JSON.stringify({\n    data,\n    ts: Date.now()\n  }))\n}\n\nfunction loadCache() {\n  const cache = localStorage.getItem('fundingRatesCache')\n  if (!cache) return null\n  try {\n    const obj = JSON.parse(cache)\n    // �u��10���������֨�\n    if (Date.now() - obj.ts < 10 * 60 * 1000) {\n      return obj.data\n    }\n  } catch {\n    // ignore cache parse error\n  }\n  return null\n}\n\nfunction rateClass(rate) {\n  if (rate === null || rate === undefined) return ''\n  return Math.abs(rate) > 0.5 ? 'high' : Math.abs(rate) > 0.2 ? 'mid' : ''\n}\n\nfunction formatRate(rate) {\n  return rate !== null && rate !== undefined ? rate.toFixed(4) + '%' : ''\n}\n\nfunction setSort(key) {\n  if (sortKey.value === key) {\n    sortDesc.value = !sortDesc.value\n  } else {\n    sortKey.value = key\n    sortDesc.value = false\n  }\n}\n\nconst sortedRates = computed(() => {\n  const arr = [...fundingRates.value]\n  arr.sort((a, b) => {\n    let v1 = a[sortKey.value]\n    let v2 = b[sortKey.value]\n    if (sortKey.value === 'symbol') {\n      v1 = v1?.toUpperCase() || ''\n      v2 = v2?.toUpperCase() || ''\n      return sortDesc.value ? v2.localeCompare(v1) : v1.localeCompare(v2)\n    } else {\n      v1 = v1 ?? -Infinity\n      v2 = v2 ?? -Infinity\n      return sortDesc.value ? v2 - v1 : v1 - v2\n    }\n  })\n  return arr\n})\n\nasync function fetchData() {\n  try {\n    const res = await fetch('http://localhost:5000/api/funding_rates')\n    const data = await res.json()\n    fundingRates.value = data\n    saveCache(data)\n  } catch {\n    // �p�G���ѡA�ϥΧ֨�\n    const cache = loadCache()\n    if (cache) fundingRates.value = cache\n  }\n}\n\nonMounted(() => {\n  // �������J���Χ֨�\n  const cache = loadCache()\n  if (cache) fundingRates.value = cache\n  fetchData()\n  fetchTimer = setInterval(fetchData, 30000)\n})\nonUnmounted(() => {\n  if (fetchTimer) clearInterval(fetchTimer)\n})\n</script>\n\n<style>\nbody { background: #181818; color: #eee; font-family: 'Segoe UI', Arial, sans-serif; }\n.container { max-width: 900px; margin: 40px auto; background: #222; padding: 24px; border-radius: 12px; box-shadow: 0 2px 16px #0008; }\nh2 { text-align: center; margin-bottom: 24px; color: #00bfff; }\n.refresh-btn {\n  display: block;\n  margin: 0 auto 16px auto;\n  padding: 8px 24px;\n  background: #00bfff;\n  color: #fff;\n  border: none;\n  border-radius: 6px;\n  font-size: 1em;\n  cursor: pointer;\n  transition: background 0.2s;\n}\n.refresh-btn:hover {\n  background: #0099cc;\n}\ntable { border-collapse: collapse; width: 100%; background: #222; }\nth, td { border: 1px solid #333; padding: 12px 8px; text-align: center; }\nth { background: #333; color: #fff; font-size: 1.1em; }\ntr:nth-child(even) { background: #282828; }\n.high { color: #e74c3c; font-weight: bold; background: #2c0a0a; }\n.mid { color: #f39c12; font-weight: bold; background: #2c1a0a; }\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}