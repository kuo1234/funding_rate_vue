{"ast":null,"code":"import { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createTextVNode as _createTextVNode, renderList as _renderList, Fragment as _Fragment, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = {\n  class: \"container\"\n};\nconst _hoisted_2 = {\n  key: 0\n};\nconst _hoisted_3 = {\n  key: 0\n};\nconst _hoisted_4 = {\n  key: 0\n};\nconst _hoisted_5 = {\n  key: 0\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[8] || (_cache[8] = _createElementVNode(\"h2\", null, \"Funding Rate Board\", -1 /* CACHED */)), _createElementVNode(\"button\", {\n    class: \"refresh-btn\",\n    onClick: $setup.fetchData\n  }, \"Refresh\"), _createElementVNode(\"table\", null, [_createElementVNode(\"thead\", null, [_createElementVNode(\"tr\", null, [_createElementVNode(\"th\", {\n    onClick: _cache[0] || (_cache[0] = $event => $setup.setSort('symbol')),\n    style: {\n      \"cursor\": \"pointer\"\n    }\n  }, [_cache[4] || (_cache[4] = _createTextVNode(\" Symbol \", -1 /* CACHED */)), $setup.sortKey === 'symbol' ? (_openBlock(), _createElementBlock(\"span\", _hoisted_2, _toDisplayString($setup.sortDesc ? '��' : '��'), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"th\", {\n    onClick: _cache[1] || (_cache[1] = $event => $setup.setSort('btcc')),\n    style: {\n      \"cursor\": \"pointer\"\n    }\n  }, [_cache[5] || (_cache[5] = _createTextVNode(\" BTCC \", -1 /* CACHED */)), $setup.sortKey === 'btcc' ? (_openBlock(), _createElementBlock(\"span\", _hoisted_3, _toDisplayString($setup.sortDesc ? '��' : '��'), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"th\", {\n    onClick: _cache[2] || (_cache[2] = $event => $setup.setSort('mexc')),\n    style: {\n      \"cursor\": \"pointer\"\n    }\n  }, [_cache[6] || (_cache[6] = _createTextVNode(\" MEXC \", -1 /* CACHED */)), $setup.sortKey === 'mexc' ? (_openBlock(), _createElementBlock(\"span\", _hoisted_4, _toDisplayString($setup.sortDesc ? '��' : '��'), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]), _createElementVNode(\"th\", {\n    onClick: _cache[3] || (_cache[3] = $event => $setup.setSort('bingx')),\n    style: {\n      \"cursor\": \"pointer\"\n    }\n  }, [_cache[7] || (_cache[7] = _createTextVNode(\" BINGX \", -1 /* CACHED */)), $setup.sortKey === 'bingx' ? (_openBlock(), _createElementBlock(\"span\", _hoisted_5, _toDisplayString($setup.sortDesc ? '��' : '��'), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)])])]), _createElementVNode(\"tbody\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.sortedRates, item => {\n    return _openBlock(), _createElementBlock(\"tr\", {\n      key: item.symbol\n    }, [_createElementVNode(\"td\", null, _toDisplayString(item.symbol.toUpperCase()), 1 /* TEXT */), _createElementVNode(\"td\", {\n      class: _normalizeClass($setup.rateClass(item.btcc))\n    }, _toDisplayString($setup.formatRate(item.btcc)), 3 /* TEXT, CLASS */), _createElementVNode(\"td\", {\n      class: _normalizeClass($setup.rateClass(item.mexc))\n    }, _toDisplayString($setup.formatRate(item.mexc)), 3 /* TEXT, CLASS */), _createElementVNode(\"td\", {\n      class: _normalizeClass($setup.rateClass(item.bingx))\n    }, _toDisplayString($setup.formatRate(item.bingx)), 3 /* TEXT, CLASS */)]);\n  }), 128 /* KEYED_FRAGMENT */))])])]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","onClick","$setup","fetchData","_cache","$event","setSort","style","sortKey","_hoisted_2","_toDisplayString","sortDesc","_hoisted_3","_hoisted_4","_hoisted_5","_Fragment","_renderList","sortedRates","item","key","symbol","toUpperCase","_normalizeClass","rateClass","btcc","formatRate","mexc","bingx"],"sources":["C:\\Users\\kuo\\Desktop\\btcc\\funding_rate_vue\\src\\App.vue"],"sourcesContent":["<template>\r\n  <div class=\"container\">\r\n    <h2>Funding Rate Board</h2>\r\n    <button class=\"refresh-btn\" @click=\"fetchData\">Refresh</button>\r\n    <table>\r\n      <thead>\r\n        <tr>\r\n          <th @click=\"setSort('symbol')\" style=\"cursor:pointer\">\r\n            Symbol <span v-if=\"sortKey==='symbol'\">{{ sortDesc ? '��' : '��' }}</span>\r\n          </th>\r\n          <th @click=\"setSort('btcc')\" style=\"cursor:pointer\">\r\n            BTCC <span v-if=\"sortKey==='btcc'\">{{ sortDesc ? '��' : '��' }}</span>\r\n          </th>\r\n          <th @click=\"setSort('mexc')\" style=\"cursor:pointer\">\r\n            MEXC <span v-if=\"sortKey==='mexc'\">{{ sortDesc ? '��' : '��' }}</span>\r\n          </th>\r\n          <th @click=\"setSort('bingx')\" style=\"cursor:pointer\">\r\n            BINGX <span v-if=\"sortKey==='bingx'\">{{ sortDesc ? '��' : '��' }}</span>\r\n          </th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr v-for=\"item in sortedRates\" :key=\"item.symbol\">\r\n          <td>{{ item.symbol.toUpperCase() }}</td>\r\n          <td :class=\"rateClass(item.btcc)\">{{ formatRate(item.btcc) }}</td>\r\n          <td :class=\"rateClass(item.mexc)\">{{ formatRate(item.mexc) }}</td>\r\n          <td :class=\"rateClass(item.bingx)\">{{ formatRate(item.bingx) }}</td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed, onMounted, onUnmounted } from 'vue'\r\n\r\nconst fundingRates = ref([])\r\nlet fetchTimer = null\r\n\r\nconst sortKey = ref('symbol')\r\nconst sortDesc = ref(false)\r\n\r\n// --- localStorage cache ---\r\nfunction saveCache(data) {\r\n  localStorage.setItem('fundingRatesCache', JSON.stringify({\r\n    data,\r\n    ts: Date.now()\r\n  }))\r\n}\r\n\r\nfunction loadCache() {\r\n  const cache = localStorage.getItem('fundingRatesCache')\r\n  if (!cache) return null\r\n  try {\r\n    const obj = JSON.parse(cache)\r\n    // �u��10���������֨�\r\n    if (Date.now() - obj.ts < 10 * 60 * 1000) {\r\n      return obj.data\r\n    }\r\n  } catch {\r\n    // ignore cache parse error\r\n  }\r\n  return null\r\n}\r\n\r\nfunction rateClass(rate) {\r\n  if (rate === null || rate === undefined) return ''\r\n  return Math.abs(rate) > 0.5 ? 'high' : Math.abs(rate) > 0.2 ? 'mid' : ''\r\n}\r\n\r\nfunction formatRate(rate) {\r\n  return rate !== null && rate !== undefined ? rate.toFixed(4) + '%' : ''\r\n}\r\n\r\nfunction setSort(key) {\r\n  if (sortKey.value === key) {\r\n    sortDesc.value = !sortDesc.value\r\n  } else {\r\n    sortKey.value = key\r\n    sortDesc.value = false\r\n  }\r\n}\r\n\r\nconst sortedRates = computed(() => {\r\n  const arr = [...fundingRates.value]\r\n  arr.sort((a, b) => {\r\n    let v1 = a[sortKey.value]\r\n    let v2 = b[sortKey.value]\r\n    if (sortKey.value === 'symbol') {\r\n      v1 = v1?.toUpperCase() || ''\r\n      v2 = v2?.toUpperCase() || ''\r\n      return sortDesc.value ? v2.localeCompare(v1) : v1.localeCompare(v2)\r\n    } else {\r\n      v1 = v1 ?? -Infinity\r\n      v2 = v2 ?? -Infinity\r\n      return sortDesc.value ? v2 - v1 : v1 - v2\r\n    }\r\n  })\r\n  return arr\r\n})\r\n\r\nasync function fetchData() {\r\n  try {\r\n    const res = await fetch('http://localhost:5000/api/funding_rates')\r\n    const data = await res.json()\r\n    fundingRates.value = data\r\n    saveCache(data)\r\n  } catch {\r\n    // �p�G���ѡA�ϥΧ֨�\r\n    const cache = loadCache()\r\n    if (cache) fundingRates.value = cache\r\n  }\r\n}\r\n\r\nonMounted(() => {\r\n  // �������J���Χ֨�\r\n  const cache = loadCache()\r\n  if (cache) fundingRates.value = cache\r\n  fetchData()\r\n  fetchTimer = setInterval(fetchData, 30000)\r\n})\r\nonUnmounted(() => {\r\n  if (fetchTimer) clearInterval(fetchTimer)\r\n})\r\n</script>\r\n\r\n<style>\r\nbody { background: #181818; color: #eee; font-family: 'Segoe UI', Arial, sans-serif; }\r\n.container { max-width: 900px; margin: 40px auto; background: #222; padding: 24px; border-radius: 12px; box-shadow: 0 2px 16px #0008; }\r\nh2 { text-align: center; margin-bottom: 24px; color: #00bfff; }\r\n.refresh-btn {\r\n  display: block;\r\n  margin: 0 auto 16px auto;\r\n  padding: 8px 24px;\r\n  background: #00bfff;\r\n  color: #fff;\r\n  border: none;\r\n  border-radius: 6px;\r\n  font-size: 1em;\r\n  cursor: pointer;\r\n  transition: background 0.2s;\r\n}\r\n.refresh-btn:hover {\r\n  background: #0099cc;\r\n}\r\ntable { border-collapse: collapse; width: 100%; background: #222; }\r\nth, td { border: 1px solid #333; padding: 12px 8px; text-align: center; }\r\nth { background: #333; color: #fff; font-size: 1.1em; }\r\ntr:nth-child(even) { background: #282828; }\r\n.high { color: #e74c3c; font-weight: bold; background: #2c0a0a; }\r\n.mid { color: #f39c12; font-weight: bold; background: #2c1a0a; }\r\n</style>"],"mappings":";;EACOA,KAAK,EAAC;AAAW;;;;;;;;;;;;;;uBAAtBC,mBAAA,CA6BM,OA7BNC,UA6BM,G,0BA5BJC,mBAAA,CAA2B,YAAvB,oBAAkB,qBACtBA,mBAAA,CAA+D;IAAvDH,KAAK,EAAC,aAAa;IAAEI,OAAK,EAAEC,MAAA,CAAAC;KAAW,SAAO,GACtDH,mBAAA,CAyBQ,gBAxBNA,mBAAA,CAeQ,gBAdNA,mBAAA,CAaK,aAZHA,mBAAA,CAEK;IAFAC,OAAK,EAAAG,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAAEH,MAAA,CAAAI,OAAO;IAAYC,KAAsB,EAAtB;MAAA;IAAA;iDAAuB,UAC7C,qBAAYL,MAAA,CAAAM,OAAO,iB,cAAnBV,mBAAA,CAAmE,QAAAW,UAAA,EAAAC,gBAAA,CAAhCR,MAAA,CAAAS,QAAQ,kC,qCAEpDX,mBAAA,CAEK;IAFAC,OAAK,EAAAG,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAAEH,MAAA,CAAAI,OAAO;IAAUC,KAAsB,EAAtB;MAAA;IAAA;iDAAuB,QAC7C,qBAAYL,MAAA,CAAAM,OAAO,e,cAAnBV,mBAAA,CAAiE,QAAAc,UAAA,EAAAF,gBAAA,CAAhCR,MAAA,CAAAS,QAAQ,kC,qCAEhDX,mBAAA,CAEK;IAFAC,OAAK,EAAAG,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAAEH,MAAA,CAAAI,OAAO;IAAUC,KAAsB,EAAtB;MAAA;IAAA;iDAAuB,QAC7C,qBAAYL,MAAA,CAAAM,OAAO,e,cAAnBV,mBAAA,CAAiE,QAAAe,UAAA,EAAAH,gBAAA,CAAhCR,MAAA,CAAAS,QAAQ,kC,qCAEhDX,mBAAA,CAEK;IAFAC,OAAK,EAAAG,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAAEH,MAAA,CAAAI,OAAO;IAAWC,KAAsB,EAAtB;MAAA;IAAA;iDAAuB,SAC7C,qBAAYL,MAAA,CAAAM,OAAO,gB,cAAnBV,mBAAA,CAAkE,QAAAgB,UAAA,EAAAJ,gBAAA,CAAhCR,MAAA,CAAAS,QAAQ,kC,yCAItDX,mBAAA,CAOQ,iB,kBANNF,mBAAA,CAKKiB,SAAA,QAAAC,WAAA,CALcd,MAAA,CAAAe,WAAW,EAAnBC,IAAI;yBAAfpB,mBAAA,CAKK;MAL4BqB,GAAG,EAAED,IAAI,CAACE;QACzCpB,mBAAA,CAAwC,YAAAU,gBAAA,CAAjCQ,IAAI,CAACE,MAAM,CAACC,WAAW,oBAC9BrB,mBAAA,CAAkE;MAA7DH,KAAK,EAAAyB,eAAA,CAAEpB,MAAA,CAAAqB,SAAS,CAACL,IAAI,CAACM,IAAI;wBAAMtB,MAAA,CAAAuB,UAAU,CAACP,IAAI,CAACM,IAAI,0BACzDxB,mBAAA,CAAkE;MAA7DH,KAAK,EAAAyB,eAAA,CAAEpB,MAAA,CAAAqB,SAAS,CAACL,IAAI,CAACQ,IAAI;wBAAMxB,MAAA,CAAAuB,UAAU,CAACP,IAAI,CAACQ,IAAI,0BACzD1B,mBAAA,CAAoE;MAA/DH,KAAK,EAAAyB,eAAA,CAAEpB,MAAA,CAAAqB,SAAS,CAACL,IAAI,CAACS,KAAK;wBAAMzB,MAAA,CAAAuB,UAAU,CAACP,IAAI,CAACS,KAAK,yB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}